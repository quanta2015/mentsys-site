{"ast":null,"code":"import \"antd/es/message/style\";\nimport _message from \"antd/es/message\";\nimport { observable, action, makeAutoObservable } from 'mobx';\nimport BaseActions from '@/component/BaseActions';\nimport { toJS } from 'mobx';\nimport { isN } from '@/util/fn.js';\nimport { get, post } from '@/util/net.js';\nimport req from '@/util/request.js';\nimport { saveToken } from '@/util/token';\nimport * as urls from '@/constant/urls';\nclass Store {\n  constructor() {\n    this.user = null;\n    this.projr = [];\n    this.projh = [];\n    this.docs = [];\n    this.menu = [];\n    makeAutoObservable(this);\n  }\n  setUserObj(o) {\n    this.user = o;\n    if (o.role === 1) {\n      let schedule = isN(o.schedule) ? [] : o.schedule.split('|');\n      schedule.map((item, i) => {\n        schedule[i] = item.split('&');\n      });\n      this.user.skill = isN(o.skill) ? [] : o.skill.split('|');\n      this.user.cert = isN(o.cert) ? [] : o.cert.split('|');\n      this.user.award = isN(o.award) ? [] : o.award.split('|');\n      this.user.schedule = isN(o.schedule) ? [[], [], [], []] : schedule;\n    } else if (o.role === 0) {\n      this.user.area = isN(o.area) ? [] : o.area.split('|');\n    }\n    console.log(toJS(this.user));\n  }\n  setUserVal(v, attr) {\n    this.user[attr] = v;\n  }\n  setUserSchedule(v, attr) {\n    this.user.schedule[attr] = v;\n  }\n  async post(url, params) {\n    return await post(url, params);\n  }\n  async get(url, params) {\n    return await get(url, params);\n  }\n  async login(url, params) {\n    const r = await this.post(url, params);\n    if (r.code === 200) {\n      _message.info('登录成功！');\n      window.token = r.token;\n      this.setUserObj(r.data);\n      return true;\n    } else {\n      _message.error(r.msg);\n      return false;\n    }\n  }\n  async loadProj() {\n    const r = await this.post(urls.API_LOAD_PROJ);\n    console.log(r);\n    // this.projr = r.projr\n    // this.projh = r.projh\n    // this.docs  = r.docs\n    return r;\n  }\n  async menuLoad() {\n    const r = await this.post(urls.API_MENU_LOAD);\n    console.log(r);\n    this.menu = r.data;\n    return r;\n  }\n}\nexport default new Store();","map":{"version":3,"names":["observable","action","makeAutoObservable","BaseActions","toJS","isN","get","post","req","saveToken","urls","Store","constructor","user","projr","projh","docs","menu","setUserObj","o","role","schedule","split","map","item","i","skill","cert","award","area","console","log","setUserVal","v","attr","setUserSchedule","url","params","login","r","code","info","window","token","data","error","msg","loadProj","API_LOAD_PROJ","menuLoad","API_MENU_LOAD"],"sources":["E:/Project/tutorManagementSystem/mentsys-site/mentsys-site/src/store/store.js"],"sourcesContent":["import { observable, action,makeAutoObservable } from 'mobx'\r\nimport BaseActions from '@/component/BaseActions'\r\nimport { message } from 'antd'\r\nimport { toJS } from 'mobx'\r\nimport { isN } from '@/util/fn.js'\r\nimport {get,post} from '@/util/net.js'\r\nimport req from '@/util/request.js'\r\nimport {saveToken} from '@/util/token'\r\nimport * as urls from '@/constant/urls'\r\n\r\n\r\nclass Store {\r\n  constructor() {\r\n    makeAutoObservable(this);\r\n  }\r\n\r\n  user = null\r\n  projr = []\r\n  projh = []\r\n  docs = []\r\n  menu = []\r\n\r\n\r\n  setUserObj(o) {\r\n    this.user = o\r\n\r\n    if (o.role===1) {\r\n      let schedule = isN(o.schedule)?[]:o.schedule.split('|')\r\n      schedule.map((item,i)=>{ schedule[i]=item.split('&')  })\r\n      this.user.skill    = isN(o.skill)?[]:o.skill.split('|')\r\n      this.user.cert     = isN(o.cert)?[]:o.cert.split('|')\r\n      this.user.award    = isN(o.award)?[]:o.award.split('|')\r\n      this.user.schedule = isN(o.schedule)?[[],[],[],[]]:schedule\r\n    }else if (o.role===0) {\r\n      this.user.area     = isN(o.area)?[]:o.area.split('|')\r\n    }\r\n    console.log(toJS(this.user))\r\n  }\r\n\r\n  setUserVal(v,attr) {\r\n    this.user[attr] = v\r\n  }\r\n\r\n  setUserSchedule(v,attr) {\r\n    this.user.schedule[attr] = v\r\n  }\r\n\r\n  async post(url, params) {\r\n    return await post(url,params)\r\n  }\r\n\r\n  async get(url, params) {\r\n    return await get(url,params)\r\n  }\r\n\r\n  async login(url, params) {\r\n    const r = await this.post(url, params)\r\n    if (r.code === 200) {\r\n      message.info('登录成功！')\r\n      window.token = r.token\r\n      this.setUserObj(r.data)\r\n      return true\r\n    }else{\r\n      message.error(r.msg)\r\n      return false\r\n    }\r\n\r\n  }\r\n\r\n  async loadProj() {\r\n    const r = await this.post(urls.API_LOAD_PROJ)\r\n    console.log(r)\r\n    // this.projr = r.projr\r\n    // this.projh = r.projh\r\n    // this.docs  = r.docs\r\n    return r\r\n  }\r\n\r\n  async menuLoad() {\r\n    const r = await this.post(urls.API_MENU_LOAD)\r\n    console.log(r)\r\n    this.menu = r.data\r\n    return r\r\n  }\r\n\r\n\r\n\r\n}\r\n\r\nexport default new Store()"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}